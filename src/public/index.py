from flask import Flask, render_template, request
from .xss_scanner import check_xss

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/scan/xss', methods=['GET', 'POST'])
def scan_xss():
    if request.method == 'POST':
        url_to_scan = request.form.get('url_to_scan')
        is_vulnerable = check_xss(url_to_scan)
        return render_template('scan_results.html', is_vulnerable=is_vulnerable, vulnerability_type='XSS')
    return render_template('xss_scan_form.html')

if __name__ == "__main__":
    app.run(debug=True)