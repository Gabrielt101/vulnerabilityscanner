from flask import Flask, render_template, request
from .xss_scanner import check_xss

app = Flask(__name__)

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/xss-form')
def xss_form():
    return render_template('xss_form.html')

@app.route('/scan/xss', methods=['POST'])
def scan_xss():
    url_to_scan = request.form['url_to_scan']
    is_vulnerable, response_text = check_xss(url_to_scan)
    return render_template('scan_results.html', is_vulnerable=is_vulnerable, url=url_to_scan, response_text=response_text)

